!function(e){e.fn.menuAim=function(e){return this.each(function(){t.call(this,e)}),this};function t(t){var n=e(this),i=null,o=[],u=null,r=null,c=e.extend({rowSelector:"> li",submenuSelector:"*",submenuDirection:"right",tolerance:75,enter:e.noop,exit:e.noop,activate:e.noop,deactivate:e.noop,exitMenu:e.noop},t),l=function(e){o.push({x:e.pageX,y:e.pageY}),o.length>3&&o.shift()},f=function(){r&&clearTimeout(r),c.exitMenu(this)&&(i&&c.deactivate(i),i=null)},a=function(){r&&clearTimeout(r),c.enter(this),v(this)},s=function(){c.exit(this)},h=function(){x(this)},x=function(e){if(e==i){c.activate(e);return}i&&c.deactivate(i),c.activate(e),i=e},v=function(e){var t=y();t?r=setTimeout(function(){v(e)},t):x(e)},y=function(){if(!i||!e(i).is(c.submenuSelector))return 0;var t=n.offset(),r={x:t.left,y:t.top-c.tolerance},l={x:t.left+n.outerWidth(),y:r.y},f={x:t.left,y:t.top+n.outerHeight()+c.tolerance},a={x:t.left+n.outerWidth(),y:f.y},s=o[o.length-1],h=o[0];if(!s||(h||(h=s),h.x<t.left||h.x>a.x||h.y<t.top||h.y>a.y||u&&s.x==u.x&&s.y==u.y))return 0;function x(e,t){return(t.y-e.y)/(t.x-e.x)}var v=l,y=a;"left"==c.submenuDirection?(v=f,y=r):"below"==c.submenuDirection?(v=a,y=f):"above"==c.submenuDirection&&(v=r,y=l);var m=x(s,v),p=x(s,y),b=x(h,v),d=x(h,y);return m<b&&p>d?(u=s,300):(u=null,0)};n.mouseleave(f).find(c.rowSelector).mouseenter(a).mouseleave(s).click(h),e(document).mousemove(l)}}(jQuery);